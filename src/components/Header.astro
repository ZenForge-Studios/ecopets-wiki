---
import "../styles/global.css";

// Reactivity para el menú móvil
const { currentPath } = Astro.props;
---

<header class="sticky top-0 z-50 bg-gradient-to-b from-gray-900 via-gray-850 to-gray-800 shadow-lg border-b border-gray-700/50 backdrop-blur-sm">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      <!-- Logo y nombre -->
      <div class="flex items-center">
        <a href="/" class="group flex items-center gap-3 transition-transform duration-300 hover:scale-105">
          <div class="relative">
            <div class="absolute -inset-0.5 rounded-full bg-gradient-to-r from-yellow-500 to-amber-600 opacity-70 blur-sm group-hover:opacity-100 transition duration-300"></div>
            <img 
              src="/favicon.png" 
              alt="EcoPets Logo" 
              class="relative h-10 w-10 rounded-full object-cover border-2 border-yellow-500/50 group-hover:border-yellow-400"
            />
          </div>
          <h1 class="text-xl font-bold bg-gradient-to-r from-yellow-400 to-yellow-600 bg-clip-text text-transparent hidden sm:block group-hover:from-amber-300 group-hover:to-yellow-400 transition-all duration-300">
            EcoPets
          </h1>
        </a>
      </div>

      <!-- Navegación desktop -->
      <div class="hidden md:flex items-center gap-4">
        <nav class="flex gap-1">
          {[
            { path: "/installation", label: "Instalación" },
            { path: "/configuration", label: "Configuración" },
            { path: "/usage", label: "Uso" },
            { path: "/pets", label: "Mascotas" }
          ].map((item) => (
            <a 
              href={item.path} 
              class:list={[
                "relative px-3 py-2 text-sm font-medium transition-all duration-300",
                "hover:text-yellow-400 rounded-md group",
                currentPath === item.path ? "text-yellow-400" : "text-gray-300"
              ]}
            >
              {item.label}
              <span class:list={[
                "absolute bottom-0 left-0 w-full h-0.5 bg-yellow-400 scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left",
                currentPath === item.path ? "scale-x-100" : ""
              ]}></span>
            </a>
          ))}
        </nav>
        <div class="border-l border-gray-700/70 h-6 mx-1"></div>
        

      </div>

      <!-- Menú móvil -->
      <div class="flex md:hidden items-center gap-3">
        
        <button 
          id="mobileMenuButton"
          class="p-2 rounded-md text-gray-400 hover:text-yellow-400 hover:bg-gray-700/50 focus:outline-none transition-all duration-300"
          aria-label="Abrir menú"
        >
          <div class="w-6 h-5 flex flex-col justify-between">
            <span id="line1" class="w-full h-0.5 bg-current transform transition-all duration-300 rounded-full"></span>
            <span id="line2" class="w-full h-0.5 bg-current transform transition-all duration-300 rounded-full"></span>
            <span id="line3" class="w-full h-0.5 bg-current transform transition-all duration-300 rounded-full"></span>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Menú móvil desplegable -->
  <div 
    id="mobileMenu"
    class="md:hidden hidden bg-gray-800/95 backdrop-blur-sm border-t border-gray-700/50 overflow-hidden transition-all duration-300"
    style="max-height: 0px;"
  >
    <div class="px-4 py-3 space-y-2">
      {[
        { path: "/installation", label: "Instalación" },
        { path: "/configuration", label: "Configuración" },
        { path: "/usage", label: "Uso" },
        { path: "/pets", label: "Mascotas"}

        
      ].map((item) => (
        <a 
          href={item.path} 
          class:list={[
            "flex items-center gap-3 px-3 py-2.5 font-medium rounded-lg transition-all duration-300",
            "hover:bg-gray-700/70 active:scale-97",
            currentPath === item.path ? "bg-gray-700/50 text-yellow-400" : "text-gray-300"
          ]}
        >
          {item.label}
        </a>
      ))}
      <div class="border-t border-gray-700/30 my-2"></div>
      <div class="flex gap-3 px-3">

      </div>
    </div>
  </div>
  
</header>

<script is:inline>
  // Menú móvil con animación
  document.getElementById('mobileMenuButton').addEventListener('click', function() {
    const menu = document.getElementById('mobileMenu');
    const line1 = document.getElementById('line1');
    const line2 = document.getElementById('line2');
    const line3 = document.getElementById('line3');
    const isHidden = menu.classList.contains('hidden');
    
    // Animación del botón hamburguesa
    if (isHidden) {
      line1.classList.add('rotate-45', 'translate-y-2');
      line2.classList.add('opacity-0');
      line3.classList.add('-rotate-45', '-translate-y-2');
    } else {
      line1.classList.remove('rotate-45', 'translate-y-2');
      line2.classList.remove('opacity-0');
      line3.classList.remove('-rotate-45', '-translate-y-2');
    }
    
    menu.classList.toggle('hidden', !isHidden);
    
    // Animación suave
    if (isHidden) {
      menu.style.maxHeight = '0';
      menu.style.overflow = 'hidden';
      setTimeout(() => {
        menu.style.maxHeight = menu.scrollHeight + 'px';
        setTimeout(() => {
          menu.style.overflow = 'visible';
          menu.style.maxHeight = 'none';
        }, 300);
      }, 10);
    } else {
      menu.style.maxHeight = menu.scrollHeight + 'px';
      menu.style.overflow = 'hidden';
      setTimeout(() => {
        menu.style.maxHeight = '0';
        setTimeout(() => {
          menu.classList.add('hidden');
        }, 300);
      }, 10);
    }
  });

    const currentPath = window.location.pathname;
    document.querySelectorAll('a').forEach(link => {
      if (link.getAttribute('href') === currentPath) {
        link.classList.add('text-yellow-400');
        const indicator = link.querySelector('span');
        if (indicator) indicator.classList.add('scale-x-100');
      }
    });
</script>

<style>
  @keyframes slideDown {
    from { transform: translateY(-20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  
  @keyframes slideUp {
    from { transform: translateY(0); opacity: 1; }
    to { transform: translateY(-20px); opacity: 0; }
  }
  
  .animate-slideDown {
    animation: slideDown 0.3s ease forwards;
  }
  
  .animate-slideUp {
    animation: slideUp 0.3s ease forwards;
  }
  
  .active:scale-97 {
    transform: scale(0.97);
  }
  
  @media (max-width: 768px) {
    #mobileMenu {
      transition: max-height 0.3s ease, opacity 0.3s ease;
    }
  }
</style>